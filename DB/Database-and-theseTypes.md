# Домашнее задание к занятию "Базы данных и их типы" - `Хамуро Илья`

### Задание 1
Кейс
Крупная строительная компания, которая также занимается проектированием и девелопментом, решила создать правильную архитектуру для работы с данными. Ниже представлены задачи, которые необходимо решить для каждой предметной области.

Какие типы СУБД, на ваш взгляд, лучше всего подойдут для решения этих задач и почему?

1.1. Бюджетирование проектов с дальнейшим формированием финансовых аналитических отчётов и прогнозирования рисков. СУБД должна гарантировать целостность и чёткую структуру данных.

Рекомендуемая СУБД: Реляционная (PostgreSQL, Microsoft SQL Server, Oracle)
Почему?

- Требуется строгая структура, ACID-гарантии, сложные JOIN-запросы для аналитики.

- Поддержка транзакций критична для финансовых данных.

- Возможность интеграции с BI-инструментами (Power BI, Tableau).

1.1.* Хеширование стало занимать длительно время, какое API можно использовать для ускорения работы?

API: Можно использовать Redis API (кеширование промежуточных результатов) или специализированные библиотеки (например, Google CityHash для быстрого хеширования).

1.2. Под каждый девелоперский проект создаётся отдельный лендинг, и все данные по лидам стекаются в CRM к маркетологам и менеджерам по продажам. Какой тип СУБД лучше использовать для лендингов и для CRM? СУБД должны быть гибкими и быстрыми.

Рекомендуемые СУБД:

Лендинги: Документоориентированная (MongoDB, Firebase) – гибкость, быстрое чтение/запись.

CRM: Реляционная (PostgreSQL) или гибрид (MongoDB + SQL для аналитики).

1.2.* Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?

Да, если: Использовать PostgreSQL с JSONB (гибкость для лендингов + структура для CRM).

Альтернатива – MongoDB (если CRM не требует сложных JOIN).

1.3. Отдел контроля качества решил создать базу по корпоративным нормам и правилам, обучающему материалу и так далее, сформированную согласно структуре компании. СУБД должна иметь простую и понятную структуру.

Рекомендуемая СУБД: Графовая (Neo4j) или реляционная (PostgreSQL).
Почему?

Если данные иерархичны (например, дерево документов), подойдёт PostgreSQL с рекурсивными запросами.

Если важны связи (например, правила → отделы → проекты), лучше Neo4j.

1.3.* Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это реализовать?

Да, если: Взять PostgreSQL из 1.1 или 1.2 и добавить таблицы для документов.

1.4. Департамент логистики нуждается в решении задач по быстрому формированию маршрутов доставки материалов по объектам и распределению курьеров по маршрутам с доставкой документов. СУБД должна уметь быстро работать со связями.

Рекомендуемая СУБД: Графовая (Neo4j) или реляционная с гео-расширениями (PostgreSQL + PostGIS).
Почему?

Графы идеальны для маршрутизации (поиск кратчайшего пути).

PostGIS удобен для работы с координатами.

1.4.* Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД логистов?

Да, если: Использовать PostgreSQL (логистика + закупки в одной схеме).

Нет, если: Закупкам нужна специализированная система (например, ERP-модуль).

1.5.* Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?

PostgreSQL (с JSONB, PostGIS, рекурсивными запросами) покрывает 90% задач:

Финансы (1.1) – транзакции.

CRM (1.2) – гибкость через JSONB.

База знаний (1.3) – иерархии.

Логистика (1.4) – PostGIS.

Исключение: Для сложной маршрутизации лучше добавить Neo4j.

Альтернатива:

MongoDB + PostgreSQL + Redis (оптимально для масштабирования).

### Задание 2 Транзакции

2.1. Пользователь пополняет баланс счёта телефона, распишите пошагово, какие действия должны произойти для того, чтобы транзакция завершилась успешно. Ориентируйтесь на шесть действий.

1) Старт транзакции – СУБД начинает транзакцию, блокируя необходимые данные (баланс пользователя).

2) Проверка реквизитов – Система проверяет, существует ли указанный номер телефона и доступен ли для пополнения.

3) Списание средств с плательщика – Если пополнение идёт с карты/кошелька, списывается сумма.

4) Зачисление средств на счёт телефона – Баланс номера увеличивается на указанную сумму.

5) Фиксация операции в логе – Запись о транзакции сохраняется в историю (для отката при ошибке).

6) Фиксация транзакции (COMMIT) – Если все шаги успешны, транзакция завершается, изменения сохраняются.

2.1.* Какие действия должны произойти, если пополнение счёта телефона происходило бы через автоплатёж?

1) Проверка подписки на автоплатёж – Система проверяет, активен ли автоплатёж для данного номера.

2) Проверка лимитов – Если у пользователя установлен лимит (например, "не более 1000 руб./месяц"), система проверяет, не превышен ли он.

3) Автоматическое списание – Средства списываются с привязанной карты/кошелька без запроса подтверждения.

4) Уведомление пользователя – После успешного пополнения отправляется SMS/email-уведомление.

### Задание 3 SQL NoSQL

3.1. Пять преимуществ SQL-систем перед NoSQL
Гарантии ACID – Полная поддержка транзакций (атомарность, согласованность, изолированность, долговечность), что критично для финансовых и бизнес-приложений.

Строгая схема данных – Чёткая структура таблиц, типы данных, внешние ключи. Упрощает валидацию и уменьшает риск ошибок.

Мощные JOIN-запросы – Возможность сложных связей между таблицами без дублирования данных (нормализация).

Зрелость и экосистема – Большой выбор инструментов (BI, ETL, ORM), обширная документация и сообщество.

Универсальность – Одна СУБД (например, PostgreSQL) может закрывать задачи аналитики, транзакций и даже частично NoSQL-сценарии (через JSONB).

3.1. Преимущества NewSQL перед SQL и NoSQL*

NewSQL (CockroachDB, Google Spanner, YugabyteDB) – гибрид, сочетающий плюсы SQL и NoSQL:

1) Перед классическим SQL:

Горизонтальная масштабируемость – Распределённые кластеры без потери ACID (в отличие от шардинга в SQL).

Высокая отказоустойчивость – Автоматическое восстановление при падении узлов.

2) Перед NoSQL:

Полная поддержка SQL-синтаксиса – JOIN, транзакции, сложные запросы без ограничений NoSQL.

Гибридные модели данных – Можно использовать как реляционные таблицы, так и документы (как в MongoDB).

### Задание 4. Кластеры

Критерии выбора СУБД:

1) Горизонтальная масштабируемость – Система должна эффективно распределять нагрузку на 1000 узлов без деградации производительности.

2) Поддержка распределённых транзакций – Если нужны ACID-гарантии (например, для финансовых расчётов).

3) Тип рабочих нагрузок:

 OLTP (много коротких транзакций) → NewSQL (CockroachDB, YugabyteDB).
 OLAP (аналитика, сложные агрегации) → Колоночные СУБД (ClickHouse, Apache Druid).
Гибридные задачи → Greenplum, Vertica.

4) Отказоустойчивость – Автоматическое восстановление при падении узлов.

5) Скорость обработки запросов – Минимизация задержек при работе с большими данными.

Если нужна аналитика → ClickHouse (MPP) – максимальная скорость агрегаций.

Если нужны транзакции + масштабируемость → CockroachDB (NewSQL, Shared-Nothing).

Если данные смешанные (OLTP + OLAP) → TiDB (гибридный подход).
